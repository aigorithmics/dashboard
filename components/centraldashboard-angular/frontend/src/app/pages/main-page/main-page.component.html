<mat-sidenav-container class="sidenav-container">
  <mat-sidenav
    #drawer
    fixedInViewport
    [attr.role]="(isHandset$ | async) ? 'dialog' : 'navigation'"
    [mode]="(isHandset$ | async) ? 'over' : 'side'"
    [opened]="(isHandset$ | async) === false && !isIframed"
    >
    <mat-toolbar class="nav-toolbar">Menu</mat-toolbar>
    <mat-nav-list>
      <a
        mat-list-item
        routerLink="/"
        [queryParams]="getNamespaceParams(currentNamespace)"
        [routerLinkActive]="['active']"
        [routerLinkActiveOptions]="{ exact: true }"
        [attr.data-cy-sidenav-menu-item]="'Home'"
        >
        <span class="text-white center">
          <mat-icon>home</mat-icon> Home
        </span>
      </a>
      @for (link of menuLinks; track $index) {
        @if (link.type === 'section' && link.items?.length) {
          <mat-expansion-panel hideToggle>
            <mat-expansion-panel-header>
              <mat-icon>{{ link.icon.split(':').pop() }}</mat-icon>{{ link.text }}
            </mat-expansion-panel-header>
            @for(subitem of link.items; track $index) {
              <a
                mat-list-item
                [routerLink]="getUrlPath(subitem.link, currentNamespace)"
                [fragment]="getUrlFragment(subitem.link)"
                [queryParams]="getNamespaceParams(currentNamespace)"
                [class.active]="isLinkActive(subitem.link)"
                [attr.data-cy-sidenav-menu-item]="subitem.text"
                >
                <span class="text-white center">
                  {{ subitem.text }}
                </span>
              </a>
            }
          </mat-expansion-panel>
        } @else {
          <a
            mat-list-item
            [routerLink]="getUrlPath(link.link, currentNamespace)"
            [fragment]="getUrlFragment(link.link)"
            [queryParams]="getNamespaceParams(currentNamespace)"
            [class.active]="isLinkActive(link.link)"
            [attr.data-cy-sidenav-menu-item]="link.text"
            >
            <span class="text-white center">
              <mat-icon>{{ link.icon.split(':').pop() }}</mat-icon>{{ link.text }}
            </span>
          </a>
        }

      }

      @for(link of externalLinks; track $index) {
        <a
          mat-list-item
          [href]="link.link"
          [target]="link.iframe ? '' : '_blank'"
          rel="noopener noreferrer"
          [attr.data-cy-sidenav-menu-item]="link.text"
          >
          <span class="text-white center">
            <mat-icon>{{ link.icon.split(':').pop() }}</mat-icon>{{ link.text }} <mat-icon>open_in_new</mat-icon>
          </span>
        </a>
      }

    </mat-nav-list>

    <mat-divider />
    @for(link of documentationItems; track $index) {
      <a
        mat-list-item
        [href]="link.link"
        target='_blank'
        rel="noopener noreferrer"
        [attr.data-cy-sidenav-menu-item]="link.text"
        >
        <span class="text-white center">
          {{ link.text }} <mat-icon>open_in_new</mat-icon>
        </span>
      </a>
    }

    <mat-toolbar class="footer">
      
    </mat-toolbar>
  </mat-sidenav>
  <mat-sidenav-content class="main-page-content">
    @if (!isIframed) {
      <mat-toolbar class="menu-toolbar" color="primary">
        @if (isHandset$ | async) {
          <button
            type="button"
            aria-label="Toggle sidenav"
            mat-icon-button
            (click)="drawer.toggle()"
            >
            <mat-icon aria-label="Side nav toggle icon">menu</mat-icon>
          </button>
        }
        <app-namespace-selector></app-namespace-selector>
      </mat-toolbar>
    }
    <router-outlet></router-outlet>
  </mat-sidenav-content>
</mat-sidenav-container>
